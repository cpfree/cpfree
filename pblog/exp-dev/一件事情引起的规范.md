# 经验

## 示例一: 通知模块引发的问题

1. 空间成本是最廉价的

## 示例二: 国开行数据问题

基础功能: 用户打开一个配置的增删改查页面, 对一个功能进行配置
问题: 新的用户在打开页面的时候, 后台数据库是没有该用户关于该配置功的数据的, 导致新用户打开该界面的时候, 首先先新增一些个人的配置的数据, 导致新用户配置的时候比较麻烦.
需求: 新用户在打开这个配置界面的时候, 页面事先默认有一些初始数据.

> 这是一个给银行内部交易员使用的系统, 大概两三百人.

方案A: 用户在打开这个界面的时候, 做一个判断, 如果是新用户, 则在前端生成一批数据, 如果新用户进行修改, 则保存数据到数据库
方案B: 用户在打开这个界面的时候, 判断往后台插入数据.
方案C: 用户在初始化建立的时候, 即为新用户插入一整套模板数据


1. 空间成本是最廉价的
   没必要为了那点空间, 导致可维护性提高 和项目变得复杂.

2. 基础功能简单化
   基础功能应该是最简单的, 从用户打开哪个配置页面, 到增删改查操作, 前后端应该是一套很简单的代码, 使用方案A,B, 都会使简单的代码变得复杂
   判断是否是新用户, 之后再操作是个破坏局部简单性的行为, 不如将这些东西统一起来, 放到新增用户的地方.

3. 单一职责原则, 单一流程编程
   增删改查这个功能很基础, 用户登录即从数据库里面获取数据, 这是一个一条线的步骤, 额外加一个判断, 就导致这条线中间多了一个分支
   > 加个判断会导致流程分叉, 增加程序可读性, 假如日后这个功能需要改动, 会增加修改难度, 同时容易出现bug, 例如下一个程序员仅仅修改了一个分支, 而事实上, 另外一个分支可能会受影响

4. 内核容易变得复杂, 节点之间的连接容易变得复杂

   尽量保持这些复杂的东西简单一点
   高内聚, 一个好的内核是, 即便内聚的事物越来越多, 但是内核结构并没有怎么变化.

5. 优先增加同种量级, 尽量不要增加不同类型

   架构方面: 优先增加节点, 尽量不要增多种类
   代码方面: 能精简就精简.
   数据方面: 优先增加同种数据的量级, 而不是增加数据的类型, 

6. 优先改节点, 而不是修改线段

   A 和 B 之间有一个连接, 尽量保持这个链接很简单, 能满足很多要求, 尽量不要改.
   若是有新的需求, 在A和B的节点层面做更改, 尽量不要去修改这个 A 和 B 的连接的线

   > A, B之间传输消息, 只应该传输最少量的数据, 

7. 需求增加, 优先更改调用方, 而不是被调用方
   被调用方需要满足很多条件, 尽量不要改动
   对于这个功能来说, 

8. 优先更改数据, 而不是代码
   数据很容易处理, 但是代码就不一样了
   数据很容易配置修改, 甚至直接删除.
   但是代码就很难修改, 变更也特别麻烦.





## 最少指导原则, 数据多次获取问题

A -> B

A 里面用到了数据 p, B里面也用到了数据P, 而数据P是可以通过 C 来获取到的, 那么A传输参数到B的时候, 该不该把数据P传输给B

1. 不传输
   这样可以保值代码的简单, 大不了在B里面在获取一次, 可能有些麻烦, 但是这样代码会简单很多, 也更加易读.

   但是这样有一个问题, 若 A, B 两次通过 C 获取的P 不一样就会很容易引发程序bug
   > 如P是一个当前即时时间, 或者从数据库中获取P两次造成读的不一致.


