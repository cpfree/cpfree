# 高并发下怎么优化能避免服务器压力过大

用户多，不代表你服务器访问量大，访问量大不一定你服务器压力大！我们换成专业点的问题，高并发下怎么优化能避免服务器压力过大？

1. 整个架构:可采用分布式架构，利用微服务架构拆分服务部署在不同的服务节点，避免单节点宕机引起的服务不可用！

2. 数据库:采用主从复制，读写分离，甚至是分库分表，表数据根据查询方式的不同采用不同的索引比如 b tree，hash，关键字段加索引，sql 避免复合函数，避免组合排序等，避免使用非索引字段作为条件分组，排序等！减少交互次数，一定不要用 select \*！

3. 加缓存:使用诸如 memcache，redis，ehcache 等缓存数据库定义表，结果表等等，数据库的中间数据放缓存，避免多次访问修改表数据！登录信息 session 等放缓存实现共享！诸如商品分类，省市区，年龄分类等不常改变的数据，放缓存，不要放数据库！

   同时要避免缓存雪崩和穿透等问题的出现导致缓存崩溃！

4. 增量统计:不要实时统计大量的数据，应该采用晚间定时任务统计，增量统计等方式提前进行统计，避免实时统计的内存，CPU 压力！

5. 加图片服务器:图片等大文件，一定要单独经过文件服务器，避免 IO 速度对动态数据的影响！保证系统不会因为文件而崩溃！

6. HTML 文件，枚举，静态的方法返回值等静态化处理，放入缓存！

7. 负载均衡:使用 nginx 等对访问量过大的服务采用负载均衡，实现服务集群，提高服务的最大并发数，防止压力过大导致单个服务的崩溃！

8. 加入搜索引擎:对于 sql 中常出现的 like，in 等语句，使用 lucence 或者 solr 中间件，将必要的，依赖模糊搜索的字段和数据使用搜索引擎进行存储，提升搜索速度！#注意:全量数据和增量数据进行定时任务更新！

9. 使用消息中间件:对服务之间的数据传输，使用诸如 rabbit mq，kafka 等等分布式消息队列异步传输，防止同步传输数据的阻塞和数据丢失！

10. 抛弃 tomcat:做 web 开发，接触最早的应用服务器就是 tomcat 了，但是 tomcat 的单个最大并发量只能不到 1w！采取 netty 等 actor 模型的高性能应用服务器！

11. 多线程:现在的服务器都是多核心处理模式，如果代码采用单线程，同步方式处理，极大的浪费了 CPU 使用效率和执行时间！

12. 避免阻塞:避免 bio，blockingqueue 等常常引起长久阻塞的技术，而改为 nio 等异步处理机制！

13. CDN 加速:如果访问量实在过大，可根据请求来源采用 CDN 分流技术，避免大流量完成系统崩溃！

14. 避免低效代码:不要频繁创建对象，引用，少用同步锁，不要创建大量线程，不要多层 for 循环！
