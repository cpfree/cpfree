# 检查SQL清单

## explain

查看sql 执行计划, 注意下走不走索引.

## delete

操作delete或者update语句，加个limit(SQL后悔药）
在执行删除或者更新语句，尽量加上limit，以下面的这条 SQL 为例吧：

1. 使用命令行或navicat 操作 delete或者是update语句最好是先查一下, 或在执行删除和更新语句的时候, 尽量加个limit
   这样可以防止

   - 降低sql写错的代价.
   - 避免长事务
   - 数据量大的时候, 容易把CPU打满.

2. 修改或删除重要数据前，要先备份，先备份，先备份

## 关于 char 和 varchar 的选择

1. MyISAM数据表，最好使用固定长度的数据列代替可变长度的数据列。

2. InnoDB 存储引擎
   建议使用VARCHAR类型。
   对于InnoDB数据表，内部的行存储格式没有区分固定长度和可变长度列（所有数据行都使用指向数据列值的头指针），因此在本质上，使用固定长度的CHAR列不一定比使用可变长度VARCHAR列简单。因而，主要的性能因素是数据行使用的存储总量。由于CHAR平均占用的空间多于VARCHAR，因此使用VARCHAR来最小化需要处理的数据行的存储总量和磁盘I/O是比较好的。

3. MEMORY存储引擎
   MEMORY数据表目前都使用固定长度的数据行存储，因此无论使用CHAR或VARCHAR列都没有关系。两者都是作为CHAR类型处理的。


## 表结构命名


索引命名要规范，主键索引名为 pk_ 字段名；唯一索引名为 uk _字段名 ；普通索引名则为 idx 字段名。（SQL规范优雅）

说明：pk 即 primary key；uk _ 即 unique key；idx _ 即 index 的简称。


如果修改/更新数据过多，考虑批量进行。

   大批量操作会会造成主从延迟。
   大批量操作会产生大事务，阻塞。
   大批量操作，数据量过大，会把cpu打满。
