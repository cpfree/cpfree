---
keys: 代理,中介,正向代理,反向代理
type: blog
url: <>
id: 220111-163111
---

# 中介 & 正向代理 & 反向代理

> 以下内容为个人感悟, 欢迎大家交流指正

> `中介`和`代理`, `直/间接代理`, `正/反向代理`, 很多特牛叉的人都傻傻分不清.

## 代理 & 中介

- 代理

   **代理就是`经授权方授权`后,代表授权方处理一些事务**

   > 注意这个地方有两层意思, 一个是`经授权方授权`, 二是`代表授权方`.

- 中介

   中介是介于`一个流程中的`, 协调流程中`多方对象`业务的, 起到`桥梁`作用的`独立`主体.

   > 注意这个地方也有好几个概念, 一个流程中, 多方对方, 桥梁作用, 独立主体.

---

- **中介必然是代理, 但代理未必是中介**.

   中介对多方进行协调, 起到桥梁作用, 对任何一方来说, 中介都获得了这方的授权, 代理其处理一些业务, 因此中介是对多方的代理.

   而代理方要想成为中介, 只有满足以下条件, 那么这个代理才能说是中介.
   
   - 对一个流程中的多方均有代理.
   - 起到了桥梁作用
   - 本身独立于各方之外, 是独立主体.

1. 对于程序员来说, 中介和代理比较直观的印象就是`中介者模式`和`代理模式`.

   `中介者模式` 在多方起到桥梁作用, 是个星性结构, 而代理模式, ememe... 就是代理.

2. 对于普通人来说, 中介和代理比较直观的印象就是`租房的中介`, 和`在携程上买火车票`.

   租房的中介同时协调房东和租客, 在其中起到桥梁作用.

   租房过程中, 房东和租客, 可以完全不见面的, 全部由中介代理双方处理交接事宜.

   在携程上买火车票(额...虽然现在携程上买票也很难), 就是携程网代理你去购买火车票啊!

3. 在社会上, 最直观的就是中介公司和代理公司了

   处理事情, 找中介公司和代理公司的时候首先收的服务费就不一样.

   代理普遍收的时`单方费用`, 收的比较贵, 而中介一般是收`多方费用`, 收的费用还是比较贵啊😒.

### 正向代理和反向代理

**正向代理和反向代理都是代理, 但是代理未必一定是正向代理或者反向代理!**

只有涉及到`服务提供方`和`服务消费方`的代理才分正向代理和反向代理.

> 例如, 100 个家庭开会, 其中 5 个家庭派出了老王为代表参加会议, 此时老王是 5 个家庭的代理, 但是开会不涉及到服务提供方和消费方, 所以此时没有正向代理和反向代理一说.
> 这就是最普通的代理, 即便要杠, 那这个代理也顶多是正向代理, 而没有反向代理.

一般来说, 我们将一个服务流程中的节点分为`服务提供方`和`服务消费方`.

- `正向代理`就是对`服务消费方`的代理,
- `反向代理`就是对`服务提供方`的代理,

> 为啥对`服务消费方`的代理是正向代理呢?
>
> 以下是我个人瞎 BB, 仅供参考!
>
> 正如上面那个老王开会, 对大众节点的代理一般是最常见的代理, 这是大众心中普遍认定的代理方式, 而对`服务提供方`的代理就显得和大众认知不同, 且代理方向相反, 因此就称为反向代理了.

### 正/反向代理举例(客户端访问服务器)

此时服务器是`服务提供方`, 客户端是`服务消费方`

| 代理方式 | 授权方 | 代理方式     | 直接交互方式                                           |
| -------- | ------ | ------------ | ------------------------------------------------------ |
| 正向代理 | 客户端 | 对客户端代理 | 代理和服务器进行直接交互, 代理对客户端的流量进行转发 |
| 反向代理 | 服务端 | 对服务器代理 | 代理和客户端进行直接交互, 代理对服务器的流量进行转发 |

1. 正向代理示例

   - 中国访问外网, 开个 vpn 或 V2rayN, 对客户发送的数据进行代理. 此时代理服务器和服务器进行直接交互, 服务器不知道真正访问的客户端是哪个.

   此时 vpn 是`服务消费方`找的, 是否进行代理是由`服务消费方`进行控制的.

2. 反向代理示例

   - nginx 代理服务器, 客户端发送请求给 nginx, 客户端直接与 nginx 进行交互, 根本不知道真正的服务器是哪个.

   此时 nginx 是`服务提供方`找的, 是否进行代理是由`服务提供方`进行控制的.

### 中介/代理举例(老师收作业)

整个流程是学生需要把做的作业交给老师, 此时老师是`服务提供方`, 学生是`服务消费方`.

老师有个职能是`收作业`, 而学生的职能是`交作业`.

一个老师负责几个班, 老师直接一个个地去收学生们的作业, 比较累, 学生每次交作业还要眼巴巴地等老师上课时来收取, 或者是屁颠颠地跑到老师办公室交作业, 这个过程个很麻烦.

为了解决上面这个痛点, 班里共经历了以下几种解决方式.

- **方式一**

   老师有比较懒, 学生学习任务也很重, 班长, 课代表学习任务也很重, 都不想承担这份工作.

   但班里有个助教, 助教不是班里人, 且**平时比较闲**, 学校给助教点`辛苦费`, 于是就变成了学生交作业给助教, 助教将作业整理完毕后给老师.

   此时的流程是, 苦逼的助教直接一个个的去收取全班人员的作业, 之后把作业交给老师.

   此时, 老师和同学之间隔一个助教, 学生不需要直接和老师进行交互, 那么可以这么看

   - 助教是对老师的代理: 助教获得了老师`收作业`的职能, 代表老师去向全班学生收取作业.

   - 助教是对学生的代理: 助教获得了学生`交作业`的职能, 代表全班同学将作业交给了老师.

   此时助教同时对一个流程的多方同时进行了代理, 在整个流程中起到了协调作用, 且是个独立主体, 那么此时助教就是个`中介`.

   注意此时的`老师向同学收作业`流程变成了两个流程, 一个是助教和老师之间的收发作业流程, 一个是助教和学生之间的收发作业流程

   > 此时若是由于助教原因发生收作业失败(助教并非有意), 那么从法律意义上, 助教应该为业务流程承担责任.

- **方式二**

   后来助教不干了, 于是老师为了收取作业, 不得不将收发作业的工作分配给课代表, 给了课代表点`辛苦费`, 由课代表代替原来助教的工作.

   但此时课代表不是一个独立的主体, 他获得了老师授权的`收作业`的职能, 但却没有获得学生们`交作业`的职能.

   此时仅仅有一个代理, 那就是课代表对老师`收作业`职能的代理.

   **此时真正的收交作业的交互仅仅发生在课代表和同学之间**.

   课代表是对老师的代理: 课代表获得了老师收作业的职能, 代表老师去向全班学生收取作业.

   而课代表和老师之间的作业移交只能说是代理的`转发`职能, 不能说是学生的`交作业`职能.

   因此此时, 课代表并不是一个中介, 而是对老师`收作业`职能的代理.

   而`收作业`是服务提供方的职能, 因此是`反向代理`.

   > 此时若是由于课代表原因发生收作业失败(课代表并非有意), 那么从法律意义上, 因为课代表是只是对老师职能的代理, 因此老师需要承担课代表造成的行为后果.

- **方式三**

   课代表太累了, 于是老师将一个班分成了几个小组, 每个小组选了一个小组长.

   此时的流程是, 小组长直接收取学生们的作业, 之后再将作业交给课代表, 课代表再将作业交给老师.

   > 此时, 老师和同学之间隔一个课代表和一个小组长, 那么问题来了,
   >
   > 1. 真正收作业的交互是在哪里呢?
   > 2. 小组长和课代表哪个是正向代理`或`反向代理呢?

---

> **先别往下看, 给你们个时间思考一下**!
> ![思考](https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2.doubanio.com%2Fview%2Fthing_review%2Fl%2Fpublic%2Fp6556491.jpg)

---

**情况是这样的**!

小组长收取学生作业, 课代表收取小组长作业, 老师收取课代表作业.

这三个流程中, 看似如下.

- 小组长拥有向学生`收作业`的职能, 同时有向课代表`交作业`的职能.
- 课代表拥有向小组长`收作业`的职能, 同时有向老师`交作业`的职能.

但是, 由于**小组长和课代表的权利均是由老师授权的**. 因此小组长和课代表**均是老师的代理**.

> 😂 老师收学生作业天经地义，一群学生哪有什么代理啊！

这时候课代表所谓的`收/交作业`职能, 以及小组长的`交作业`职能也不能看作是`收/交作业`的职能, 而是代理专有的`代理转发`的职能.

而老师是`服务提供方`, 因此小组长和课代表**均是反向代理**.

- 课代表直接和老师进行交互, 因此在此是`直接反向代理`.
- 小组长间接和老师进行交互, 因此在此是`间接反向代理`.

**真正收作业的交互就是在`小组长`和`同学`之间**.

> 😂 不会有人想着真正收作业的交互就是在`小组长`和`课代表`之间吧!

---

当然了，假如说几个学生 A, B, C, D 相互是邻居，A,B, C 三人吃坏肚子生病了.

此时 A,B, C 将自己的作业统统交给了 D, 让 D 把作业转交给老师, 此时 D 是由 A, B, C 三人`授权`的，因此 D 是 A，B，C 的`直接正向代理`.

但如果 A,B,C 没主动交作业, 老师派 D 来向 A,B,C 三人收作业, 那么此时 `D`是由老师授权的, 那么 D 还是老师的`反向代理`哈😃.
